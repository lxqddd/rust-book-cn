## 附录 B: 运算符和符号

本附录包含了 Rust 语法的词汇表，包括运算符和其他符号，这些符号可以单独出现，也可以出现在路径、泛型、trait 约束、宏、属性、注释、元组和括号的上下文中。

### 运算符

表 B-1 包含了 Rust 中的运算符，展示了运算符在上下文中的使用示例、简要说明以及该运算符是否可重载。如果运算符可重载，还会列出用于重载该运算符的相关 trait。

<span class="caption">表 B-1: 运算符</span>

| 运算符                  | 示例                                                 | 说明                                                           | 可重载?  |
| ------------------------- | ------------------------------------------------------- | --------------------------------------------------------------------- | -------------- |
| `!`                       | `ident!(...)`, `ident!{...}`, `ident![...]`             | 宏扩展                                                       |                |
| `!`                       | `!expr`                                                 | 按位或逻辑取反                                         | `Not`          |
| `!=`                      | `expr != expr`                                          | 不等比较                                                | `PartialEq`    |
| `%`                       | `expr % expr`                                           | 算术取余                                                  | `Rem`          |
| `%=`                      | `var %= expr`                                           | 算术取余并赋值                                   | `RemAssign`    |
| `&`                       | `&expr`, `&mut expr`                                    | 借用                                                                |                |
| `&`                       | `&type`, `&mut type`, `&'a type`, `&'a mut type`        | 借用指针类型                                                 |                |
| `&`                       | `expr & expr`                                           | 按位与                                                           | `BitAnd`       |
| `&=`                      | `var &= expr`                                           | 按位与并赋值                                            | `BitAndAssign` |
| `&&`                      | `expr && expr`                                          | 短路逻辑与                                          |                |
| `*`                       | `expr * expr`                                           | 算术乘法                                             | `Mul`          |
| `*=`                      | `var *= expr`                                           | 算术乘法并赋值                              | `MulAssign`    |
| `*`                       | `*expr`                                                 | 解引用                                                           | `Deref`        |
| `*`                       | `*const type`, `*mut type`                              | 裸指针                                                           |                |
| `+`                       | `trait + trait`, `'a + trait`                           | 复合类型约束                                              |                |
| `+`                       | `expr + expr`                                           | 算术加法                                                   | `Add`          |
| `+=`                      | `var += expr`                                           | 算术加法并赋值                                    | `AddAssign`    |
| `,`                       | `expr, expr`                                            | 参数和元素分隔符                                        |                |
| `-`                       | `- expr`                                                | 算术取反                                                   | `Neg`          |
| `-`                       | `expr - expr`                                           | 算术减法                                                | `Sub`          |
| `-=`                      | `var -= expr`                                           | 算术减法并赋值                                 | `SubAssign`    |
| `->`                      | `fn(...) -> type`, <code>&vert;...&vert; -> type</code> | 函数和闭包返回类型                                      |                |
| `.`                       | `expr.ident`                                            | 字段访问                                                          |                |
| `.`                       | `expr.ident(expr, ...)`                                 | 方法调用                                                           |                |
| `.`                       | `expr.0`, `expr.1`, etc.                                | 元组索引                                                        |                |
| `..`                      | `..`, `expr..`, `..expr`, `expr..expr`                  | 右开区间字面量                                         | `PartialOrd`   |
| `..=`                     | `..=expr`, `expr..=expr`                                | 右闭区间字面量                                         | `PartialOrd`   |
| `..`                      | `..expr`                                                | 结构体字面量更新语法                                          |                |
| `..`                      | `variant(x, ..)`, `struct_type { x, .. }`               | “以及其他”模式绑定                                        |                |
| `...`                     | `expr...expr`                                           | (已弃用，使用 `..=` 代替) 在模式中：闭区间模式 |                |
| `/`                       | `expr / expr`                                           | 算术除法                                                   | `Div`          |
| `/=`                      | `var /= expr`                                           | 算术除法并赋值                                    | `DivAssign`    |
| `:`                       | `pat: type`, `ident: type`                              | 约束                                                           |                |
| `:`                       | `ident: expr`                                           | 结构体字段初始化                                              |                |
| `:`                       | `'a: loop {...}`                                        | 循环标签                                                            |                |
| `;`                       | `expr;`                                                 | 语句和项终止符                                         |                |
| `;`                       | `[...; len]`                                            | 固定大小数组语法的一部分                                       |                |
| `<<`                      | `expr << expr`                                          | 左移                                                            | `Shl`          |
| `<<=`                     | `var <<= expr`                                          | 左移并赋值                                             | `ShlAssign`    |
| `<`                       | `expr < expr`                                           | 小于比较                                                  | `PartialOrd`   |
| `<=`                      | `expr <= expr`                                          | 小于或等于比较                                      | `PartialOrd`   |
| `=`                       | `var = expr`, `ident = type`                            | 赋值/等价                                                |                |
| `==`                      | `expr == expr`                                          | 相等比较                                                   | `PartialEq`    |
| `=>`                      | `pat => expr`                                           | 匹配分支语法的一部分                                              |                |
| `>`                       | `expr > expr`                                           | 大于比较                                               | `PartialOrd`   |
| `>=`                      | `expr >= expr`                                          | 大于或等于比较                                   | `PartialOrd`   |
| `>>`                      | `expr >> expr`                                          | 右移                                                           | `Shr`          |
| `>>=`                     | `var >>= expr`                                          | 右移并赋值                                            | `ShrAssign`    |
| `@`                       | `ident @ pat`                                           | 模式绑定                                                       |                |
| `^`                       | `expr ^ expr`                                           | 按位异或                                                  | `BitXor`       |
| `^=`                      | `var ^= expr`                                           | 按位异或并赋值                                   | `BitXorAssign` |
| <code>&vert;</code>       | <code>pat &vert; pat</code>                             | 模式替代                                                  |                |
| <code>&vert;</code>       | <code>expr &vert; expr</code>                           | 按位或                                                            | `BitOr`        |
| <code>&vert;=</code>      | <code>var &vert;= expr</code>                           | 按位或并赋值                                             | `BitOrAssign`  |
| <code>&vert;&vert;</code> | <code>expr &vert;&vert; expr</code>                     | 短路逻辑或                                           |                |
| `?`                       | `expr?`                                                 | 错误传播                                                     |                |

### 非运算符符号

以下列表包含了所有不作为运算符使用的符号；也就是说，它们的行为不像函数或方法调用。

表 B-2 展示了单独出现并在多种上下文中有效的符号。

<span class="caption">表 B-2: 独立语法</span>

| 符号                                        | 说明                                                            |
| --------------------------------------------- | ---------------------------------------------------------------------- |
| `'ident`                                      | 命名生命周期或循环标签                                           |
| `...u8`, `...i32`, `...f64`, `...usize`, etc. | 特定类型的数字字面量                                       |
| `"..."`                                       | 字符串字面量                                                         |
| `r"..."`, `r#"..."#`, `r##"..."##`, etc.      | 原始字符串字面量，转义字符不被处理                    |
| `b"..."`                                      | 字节字符串字面量；构造字节数组而不是字符串  |
| `br"..."`, `br#"..."#`, `br##"..."##`, etc.   | 原始字节字符串字面量，原始和字节字符串字面量的组合    |
| `'...'`                                       | 字符字面量                                                      |
| `b'...'`                                      | ASCII 字节字面量                                                     |
| <code>&vert;...&vert; expr</code>             | 闭包                                                                |
| `!`                                           | 总是空的底类型，用于发散函数                       |
| `_`                                           | “忽略”模式绑定；也用于使整数字面量更可读 |

表 B-3 展示了在模块层次结构中路径上下文中出现的符号。

<span class="caption">表 B-3: 路径相关语法</span>

| 符号                                  | 说明                                                                                                                     |
| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| `ident::ident`                          | 命名空间路径                                                                                                                  |
| `::path`                                | 相对于外部预导入的路径，所有其他 crate 的根路径（即显式绝对路径，包括 crate 名称） |
| `self::path`                            | 相对于当前模块的路径（即显式相对路径）。                                                        |
| `super::path`                           | 相对于当前模块的父模块的路径                                                                               |
| `type::ident`, `<type as trait>::ident` | 关联常量、函数和类型                                                                                      |
| `<type>::...`                           | 无法直接命名的类型的关联项（例如，`<&T>::...`, `<[T]>::...`, 等）                                |
| `trait::method(...)`                    | 通过命名定义方法的 trait 来消除方法调用的歧义                                                                |
| `type::method(...)`                     | 通过命名定义方法的类型来消除方法调用的歧义                                                          |
| `<type as trait>::method(...)`          | 通过命名 trait 和类型来消除方法调用的歧义                                                                       |

表 B-4 展示了在使用泛型类型参数的上下文中出现的符号。

<span class="caption">表 B-4: 泛型</span>

| 符号                         | 说明                                                                                                                              |
| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- |
| `path<...>`                    | 指定类型中的泛型类型参数（例如，`Vec<u8>`）                                                                         |
| `path::<...>`, `method::<...>` | 在表达式中指定泛型类型、函数或方法的参数；通常称为 turbofish（例如，`"42".parse::<i32>()`） |
| `fn ident<...> ...`            | 定义泛型函数                                                                                                                  |
| `struct ident<...> ...`        | 定义泛型结构体                                                                                                                 |
| `enum ident<...> ...`          | 定义泛型枚举                                                                                                               |
| `impl<...> ...`                | 定义泛型实现                                                                                                            |
| `for<...> type`                | 高阶生命周期约束                                                                                                            |
| `type<ident=type>`             | 一个泛型类型，其中一个或多个关联类型有特定赋值（例如，`Iterator<Item=T>`）                                   |

表 B-5 展示了在使用 trait 约束泛型类型参数的上下文中出现的符号。

<span class="caption">表 B-5: Trait 约束</span>

| 符号                        | 说明                                                                                                                                |
| ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| `T: U`                        | 泛型参数 `T` 约束为实现 `U` 的类型                                                                              |
| `T: 'a`                       | 泛型类型 `T` 必须比生命周期 `'a` 长（意味着该类型不能包含任何生命周期短于 `'a` 的引用） |
| `T: 'static`                  | 泛型类型 `T` 不包含除 `'static` 之外的借用引用                                                                 |
| `'b: 'a`                      | 泛型生命周期 `'b` 必须比生命周期 `'a` 长                                                                                           |
| `T: ?Sized`                   | 允许泛型类型参数为动态大小类型                                                                                |
| `'a + trait`, `trait + trait` | 复合类型约束                                                                                                                   |

表 B-6 展示了在调用或定义宏以及指定项属性的上下文中出现的符号。

<span class="caption">表 B-6: 宏和属性</span>

| 符号                                      | 说明        |
| ------------------------------------------- | ------------------ |
| `#[meta]`                                   | 外部属性    |
| `#![meta]`                                  | 内部属性    |
| `$ident`                                    | 宏替换 |
| `$ident:kind`                               | 宏捕获      |
| `$(…)…`                                     | 宏重复   |
| `ident!(...)`, `ident!{...}`, `ident![...]` | 宏调用   |

表 B-7 展示了创建注释的符号。

<span class="caption">表 B-7: 注释</span>

| 符号     | 说明             |
| ---------- | ----------------------- |
| `//`       | 行注释            |
| `//!`      | 内部行文档注释  |
| `///`      | 外部行文档注释  |
| `/*...*/`  | 块注释           |
| `/*!...*/` | 内部块文档注释 |
| `/**...*/` | 外部块文档注释 |

表 B-8 展示了使用括号的上下文。

<span class="caption">表 B-8: 括号</span>

| 符号                   | 说明                                                                                 |
| ------------------------ | ------------------------------------------------------------------------------------------- |
| `()`                     | 空元组（即单元），既是字面量也是类型                                               |
| `(expr)`                 | 括号表达式                                                                    |
| `(expr,)`                | 单元素元组表达式                                                             |
| `(type,)`                | 单元素元组类型                                                                   |
| `(expr, ...)`            | 元组表达式                                                                            |
| `(type, ...)`            | 元组类型                                                                                  |
| `expr(expr, ...)`        | 函数调用表达式；也用于初始化元组 `struct` 和元组 `enum` 变体 |

表 B-9 展示了使用花括号的上下文。

<span class="caption">表 B-9: 花括号</span>

| 上下文      | 说明      |
| ------------ | ---------------- |
| `{...}`      | 块表达式 |
| `Type {...}` | `struct` 字面量 |

表 B-10 展示了使用方括号的上下文。

<span class="caption">表 B-10: 方括号</span>

| 上下文                                            | 说明                                                                                                                   |
| -------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| `[...]`                                            | 数组字面量                                                                                                                 |
| `[expr; len]`                                      | 包含 `len` 个 `expr` 的数组字面量                                                                               |
| `[type; len]`                                      | 包含 `len` 个 `type` 实例的数组类型                                                                               |
| `expr[expr]`                                       | 集合索引。可重载（`Index`, `IndexMut`）                                                                       |
| `expr[..]`, `expr[a..]`, `expr[..b]`, `expr[a..b]` | 集合索引假装为集合切片，使用 `Range`, `RangeFrom`, `RangeTo`, 或 `RangeFull` 作为“索引” |