# 最终项目：构建一个多线程的 Web 服务器

这是一段漫长的旅程，但我们终于来到了本书的结尾。在这一章中，我们将一起构建一个项目，以展示我们在最后几章中涵盖的一些概念，并回顾一些早期的课程。

对于我们的最终项目，我们将制作一个 Web 服务器，它在 Web 浏览器中显示“hello”，并看起来像图 21-1。

![hello from rust](img/trpl21-01.png)

<span class="caption">图 21-1：我们的最终共享项目</span>

这是我们构建 Web 服务器的计划：

1. 学习一些关于 TCP 和 HTTP 的知识。
2. 在套接字上监听 TCP 连接。
3. 解析少量的 HTTP 请求。
4. 创建一个适当的 HTTP 响应。
5. 使用线程池提高服务器的吞吐量。

在我们开始之前，我们应该提到两个细节。首先，我们将使用的方法并不是用 Rust 构建 Web 服务器的最佳方式。社区成员已经在 [crates.io](https://crates.io/) 上发布了许多生产就绪的 crate，这些 crate 提供了比我们将要构建的更完整的 Web 服务器和线程池实现。然而，我们在本章中的意图是帮助你学习，而不是走捷径。因为 Rust 是一种系统编程语言，我们可以选择我们想要工作的抽象级别，并且可以深入到比其他语言可能或实际更低的级别。

其次，我们在这里不会使用 `async` 和 `await`。构建一个线程池本身就是一个足够大的挑战，不需要再添加构建异步运行时的复杂性！然而，我们会注意到 `async` 和 `await` 可能适用于我们在本章中看到的某些问题。最终，正如我们在第 17 章中提到的，许多异步运行时使用线程池来管理工作。

因此，我们将手动编写基本的 HTTP 服务器和线程池，以便你可以学习未来可能使用的 crate 背后的通用思想和技术。